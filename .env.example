# ===========================================
# DNS Max 环境配置模板
# ===========================================
# 这是一个环境变量配置模板文件，包含了所有可配置的选项
# 使用方法：
# 1. 复制此文件为 .env: cp .env.example .env
# 2. 根据你的环境修改相应的配置值
# 3. ⚠️ 重要：生产环境必须修改所有标记为 "CHANGE_THIS" 的值

# ===========================================
# 数据库配置
# ===========================================

# PostgreSQL 数据库连接字符串
# 格式: postgresql://用户名:密码@主机:端口/数据库名
# 开发环境示例: postgresql://dns_max_user:dns_max_password@localhost:5432/dns_max_dev
# 生产环境示例: postgresql://dns_max_user:STRONG_PASSWORD@postgres:5432/dns_max?sslmode=require
DATABASE_URL=postgresql://dns_max_user:dns_max_password@localhost:5432/dns_max

# 数据库连接池配置
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# ===========================================
# Redis 缓存配置
# ===========================================

# Redis 连接字符串
# 格式: redis://主机:端口/数据库编号
# 带密码: redis://:密码@主机:端口/数据库编号
REDIS_URL=redis://localhost:6379/0

# Redis 连接配置
REDIS_CONNECTION_POOL_SIZE=10
REDIS_SOCKET_TIMEOUT=5
REDIS_SOCKET_CONNECT_TIMEOUT=5

# ===========================================
# JWT 认证和安全配置
# ===========================================

# JWT 密钥 (⚠️ 生产环境必须修改为强随机字符串)
# 生成方法: openssl rand -hex 32
SECRET_KEY=CHANGE_THIS_TO_A_VERY_STRONG_RANDOM_KEY_AT_LEAST_32_CHARS

# Token 过期时间配置
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# 安全选项
FORCE_HTTPS=false                        # 生产环境设为 true
SECURE_COOKIES=false                     # 生产环境设为 true
HTTPONLY_COOKIES=true
SAMESITE_COOKIES=lax                     # 可选: strict, lax, none

# 密码策略
MIN_PASSWORD_LENGTH=8
REQUIRE_SPECIAL_CHARS=true
REQUIRE_NUMBERS=true
REQUIRE_UPPERCASE=true

# ===========================================
# 跨域和网络配置
# ===========================================

# CORS (跨域) 配置
# 开发环境: ["http://localhost:3000","http://localhost:3001"]
# 生产环境: ["https://yourdomain.com","https://www.yourdomain.com"]
BACKEND_CORS_ORIGINS=["http://localhost:3000","http://localhost:3001"]

# CORS 详细配置
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=["GET","POST","PUT","DELETE","OPTIONS"]
CORS_ALLOW_HEADERS=["*"]
CORS_MAX_AGE=86400

# API 配置
API_PREFIX=/api/v1
API_DOCS_URL=/docs
API_REDOC_URL=/redoc

# ===========================================
# 前端应用配置
# ===========================================

# 前端 API 请求地址
# 开发环境: http://localhost:8000/api/v1
# 生产环境: https://yourdomain.com/api/v1
NEXT_PUBLIC_API_URL=http://localhost:8000/api/v1

# 前端应用信息
NEXT_PUBLIC_APP_NAME=DNS Max
NEXT_PUBLIC_APP_VERSION=1.0.0
NEXT_PUBLIC_APP_DESCRIPTION=DNS管理平台

# 前端功能开关
NEXT_PUBLIC_ENABLE_ANALYTICS=false
NEXT_PUBLIC_ENABLE_SENTRY=false
NEXT_PUBLIC_DEBUG_MODE=false

# 前端限制配置
NEXT_PUBLIC_MAX_FILE_SIZE=5242880
NEXT_PUBLIC_SUPPORTED_LANGUAGES=en,zh

# ===========================================
# 邮件服务配置 (可选)
# ===========================================

# SMTP 服务器配置
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USE_TLS=true
SMTP_USE_SSL=false
SMTP_USERNAME=your_email@gmail.com
SMTP_PASSWORD=your_app_password
SMTP_FROM_EMAIL=noreply@yourdomain.com
SMTP_FROM_NAME=DNS Max

# 邮件功能开关
EMAIL_ENABLED=false
EMAIL_VERIFICATION_REQUIRED=false
PASSWORD_RESET_ENABLED=false

# ===========================================
# 日志和监控配置
# ===========================================

# 日志配置
LOG_LEVEL=INFO                           # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json                          # json, text
LOG_TO_CONSOLE=true
LOG_TO_FILE=false
LOG_FILE_PATH=/app/logs/dns-max.log
LOG_MAX_SIZE=100MB
LOG_BACKUP_COUNT=5
LOG_ROTATE=true

# SQL 查询日志 (开发环境可启用)
LOG_SQL_QUERIES=false

# 错误监控 (Sentry - 可选)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_RELEASE=1.0.0
SENTRY_SAMPLE_RATE=1.0
SENTRY_TRACES_SAMPLE_RATE=0.1

# ===========================================
# 性能和限流配置
# ===========================================

# API 限流配置
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_REQUESTS_PER_HOUR=1000
RATE_LIMIT_REQUESTS_PER_DAY=10000
RATE_LIMIT_KEY_PREFIX=dns_max_rate_limit

# 安全限制
MAX_LOGIN_ATTEMPTS=5
LOGIN_LOCKOUT_DURATION=900               # 15分钟
BRUTE_FORCE_PROTECTION=true

# 文件上传限制
MAX_UPLOAD_SIZE=5242880                  # 5MB
ALLOWED_FILE_TYPES=txt,csv,json

# 缓存配置
CACHE_DEFAULT_TTL=300                    # 5分钟
CACHE_LONG_TTL=3600                      # 1小时
CACHE_SHORT_TTL=60                       # 1分钟

# ===========================================
# DNS 服务商配置
# ===========================================

# DNS 操作配置
DNS_REQUEST_TIMEOUT=30
DNS_RETRY_TIMES=3
DNS_RETRY_DELAY=5

# DNS 记录 TTL 配置
DEFAULT_DNS_TTL=600
MIN_DNS_TTL=60
MAX_DNS_TTL=86400

# 批量操作限制
MAX_BATCH_SIZE=100
BATCH_OPERATION_DELAY=1

# 阿里云 DNS 配置
ALIYUN_DNS_ENDPOINT=https://dns.aliyuncs.com
ALIYUN_DNS_VERSION=2015-01-09
ALIYUN_DEFAULT_REGION=cn-hangzhou
ALIYUN_REQUEST_TIMEOUT=30

# Cloudflare DNS 配置
CLOUDFLARE_API_BASE_URL=https://api.cloudflare.com/client/v4
CLOUDFLARE_REQUEST_TIMEOUT=30
CLOUDFLARE_RATE_LIMIT_RESPECT=true

# 腾讯云 DNS 配置
TENCENT_DNS_ENDPOINT=https://dnspod.tencentcloudapi.com
TENCENT_DNS_VERSION=2021-03-23
TENCENT_DEFAULT_REGION=ap-guangzhou
TENCENT_REQUEST_TIMEOUT=30

# ===========================================
# 应用性能配置
# ===========================================

# FastAPI 工作进程配置
WORKERS_COUNT=4
MAX_WORKERS=8
WORKER_CONNECTIONS=1000
KEEPALIVE_TIMEOUT=5
GRACEFUL_TIMEOUT=30

# 异步配置
ASYNC_POOL_SIZE=20
ASYNC_MAX_OVERFLOW=0
ASYNC_POOL_TIMEOUT=30

# ===========================================
# 安全审计配置
# ===========================================

# 审计日志
AUDIT_LOG_ENABLED=false
AUDIT_LOG_LEVEL=INFO
AUDIT_LOG_RETENTION_DAYS=90
AUDIT_LOG_MAX_SIZE=100MB

# 安全监控
SECURITY_LOGGING_ENABLED=false
LOG_FAILED_LOGIN_ATTEMPTS=true
LOG_PRIVILEGE_ESCALATION=true
LOG_FILE_ACCESS=false

# 入侵检测
INTRUSION_DETECTION_ENABLED=false
SUSPICIOUS_ACTIVITY_THRESHOLD=10
AUTO_BAN_SUSPICIOUS_IPS=false
BAN_DURATION_MINUTES=60

# ===========================================
# 开发和调试配置
# ===========================================

# 开发模式开关
DEBUG_MODE=false
DEVELOPMENT_MODE=false

# 测试配置
TEST_MODE=false
SKIP_DNS_VALIDATION=false
MOCK_DNS_PROVIDERS=false
TEST_DATA_CLEANUP=false

# API 文档配置
ENABLE_API_DOCS=true
API_DOCS_AUTHENTICATION=false

# ===========================================
# 自定义配置
# ===========================================

# 应用特定配置
APP_TITLE=DNS Max
APP_DESCRIPTION=统一 DNS 管理平台
APP_VERSION=1.0.0
APP_CONTACT_EMAIL=support@yourdomain.com

# 时区配置
TIMEZONE=UTC

# 语言配置
DEFAULT_LANGUAGE=zh
SUPPORTED_LANGUAGES=en,zh

# ===========================================
# 注意事项
# ===========================================
# 1. 生产环境部署前，请务必修改以下配置：
#    - SECRET_KEY: 使用强随机字符串
#    - DATABASE_URL: 使用强密码
#    - BACKEND_CORS_ORIGINS: 仅允许信任的域名
#    - FORCE_HTTPS: 设为 true
#    - SECURE_COOKIES: 设为 true
#
# 2. 敏感信息不要提交到版本控制系统
#
# 3. 定期轮换密钥和密码
#
# 4. 监控和日志配置应根据实际需求调整
#
# 5. 性能配置应根据服务器资源进行优化